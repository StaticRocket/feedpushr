(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{337:function(e,t,n){},396:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(20),s=n.n(c),o=(n(337),n(12)),i=n(82),u=n(25),l=n(72),j=n(445),d=n(440),b=n(296),p=n(177),h=n(76),f=n(58),x=n(426),O=n(444),m=n(119),g=n(116),v=n(111),w=n(281),k=n(462),y=n(431),S=n(463),C=n(439),T=n(13),E=n.n(T),N=n(19),_=n(311),F=n(189),I=Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_ROOT||window.location.origin+window.location.pathname.replace(/\/ui(\/)*$/,""),U=[],M=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];U=[].concat(Object(F.a)(U),t)},R=function(){var e=Object(N.a)(E.a.mark((function e(t){var n,r,a,c,s,o,i=arguments;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=i.length>1&&void 0!==i[1]?i[1]:{},r=i.length>2?i[2]:void 0,a=Object(_.a)(U),e.prev=3,a.s();case 5:if((c=a.n()).done){e.next=12;break}return s=c.value,e.next=9,s(r);case 9:r=e.sent;case 10:e.next=5;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),a.e(e.t0);case 17:return e.prev=17,a.f(),e.finish(17);case 20:return o=new URL("".concat(I,"/v2").concat(t)),n&&Object.keys(n).forEach((function(e){return o.searchParams.append(e,n[e])})),e.next=24,fetch(o.toString(),r);case 24:return e.abrupt("return",e.sent);case 25:case"end":return e.stop()}}),e,null,[[3,14,17,20]])})));return function(t){return e.apply(this,arguments)}}(),A=n(312),P=n(313),L=n(147),B=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.location.origin;Object(A.a)(this,e),this.userManager=void 0,this.origin=void 0,t=Object(u.a)({response_type:"code",scope:"openid profile email"},t),this.origin=r,this.userManager=new L.UserManager(t),this.userManager.events.addUserSignedOut(Object(N.a)(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("user signed out..."),n.logout();case 2:case"end":return e.stop()}}),e)})))),this.userManager.clearStaleState(),L.Log.logger=console,L.Log.level=L.Log.WARN}return Object(P.a)(e,[{key:"getUser",value:function(){return this.userManager.getUser()}},{key:"getAccountUrl",value:function(){var e=this.userManager.settings,t=e.authority,n=e.client_id;return"".concat(t,"/account?referrer=").concat(n,"&referrer_uri=").concat(encodeURI(this.origin))}},{key:"login",value:function(){return this.userManager.signinRedirect()}},{key:"renewToken",value:function(){return this.userManager.signinSilent()}},{key:"logout",value:function(){return this.userManager.signoutRedirect()}}]),e}(),D=n(2),z={version:"snapshot",client_id:"feedpushr-ui",_links:{}},W=Object(r.createContext)(z),H=function(e){var t=e.children,n=Object(r.useState)(!0),a=Object(o.a)(n,2),c=a[0],s=a[1],i=Object(r.useState)(),u=Object(o.a)(i,2),l=u[0],j=u[1],d=Object(r.useState)(z),b=Object(o.a)(d,2),p=b[0],h=b[1];return Object(r.useEffect)((function(){var e=new AbortController;return function(){var t=Object(N.a)(E.a.mark((function t(){var n,r;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,R("/",null,{signal:e.signal});case 3:if(!(n=t.sent).ok){t.next=10;break}return t.next=7,n.json();case 7:return r=t.sent,h(r),t.abrupt("return");case 10:throw new Error(n.statusText);case 13:t.prev=13,t.t0=t.catch(0),j(t.t0);case 16:return t.prev=16,s(!1),t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[0,13,16,19]])})));return function(){return t.apply(this,arguments)}}()(),function(){return e.abort()}}),[]),Object(D.jsxs)(W.Provider,{value:p,children:[l&&Object(D.jsxs)("p",{children:["ERROR: ",l.message]}),c&&Object(D.jsx)("p",{children:"LOADING..."}),!l&&!c&&t]})},J=function(e){return function(){var t=Object(N.a)(E.a.mark((function t(n){var r,a;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getUser();case 2:if(null!==(r=t.sent)){t.next=5;break}throw new Error("user not logged in");case 5:if(!r.expired){t.next=9;break}return t.next=8,e.renewToken();case 8:r=t.sent;case 9:return r.access_token&&((a=new Headers(n.headers)).set("Authorization","Bearer ".concat(r.access_token)),n.headers=a),t.abrupt("return",n);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},G=Object(r.createContext)(null),X=function(e){var t=e.children,n=Object(r.useState)(!0),a=Object(o.a)(n,2),c=a[0],s=a[1],i=Object(r.useState)(),u=Object(o.a)(i,2),l=u[0],j=u[1],d=Object(r.useState)(null),b=Object(o.a)(d,2),p=b[0],h=b[1],f=Object(r.useContext)(W),x=f._links,O=f.client_id;return Object(r.useEffect)((function(){var e=document.location,t=e.origin,n=e.href,r=e.pathname,a=encodeURIComponent(n);(function(){var e=Object(N.a)(E.a.mark((function e(){var n,c,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=x.issuer){e.next=4;break}return s(!1),e.abrupt("return");case 4:return c=new B({authority:n.href,client_id:O,redirect_uri:"".concat(t).concat(r,"signin-callback.html?redirect=").concat(a),silent_redirect_uri:"".concat(t).concat(r,"silent-renew.html"),post_logout_redirect_uri:t+r}),M(J(c)),e.prev=6,e.next=9,c.getUser();case 9:if(null!==(o=e.sent)){e.next=16;break}return e.next=13,c.login();case 13:return e.abrupt("return",e.sent);case 16:if(!o.expired){e.next=20;break}return e.next=19,c.renewToken();case 19:o=e.sent;case 20:h(o),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(6),j(e.t0);case 26:return e.prev=26,s(!1),e.finish(26);case 29:case"end":return e.stop()}}),e,null,[[6,23,26,29]])})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(D.jsxs)(G.Provider,{value:p,children:[l&&Object(D.jsxs)("p",{children:["ERROR: ",l.message]}),c&&Object(D.jsx)("p",{children:"Connecting..."}),!l&&!c&&t]})},K=Object(r.createContext)({message:{text:"",variant:"info"},showMessage:function(){return!0}}),V=function(e){var t=e.children,n=Object(r.useState)({text:"",variant:"info"}),a=Object(o.a)(n,2),c=a[0],s=a[1];return Object(D.jsx)(K.Provider,{value:{message:c,showMessage:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";s({text:e,variant:t})}},children:t})},q=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((function(e){return e})).join(" ")},$=n(397),Q=n(399),Y=n(422),Z=n(424),ee=n(423),te=n(425),ne=n(427),re=function(){return Object(D.jsxs)($.a,{component:"nav","aria-label":"Main mailbox folders",children:[Object(D.jsxs)(Q.a,{button:!0,component:l.b,to:"/feeds",children:[Object(D.jsx)(Y.a,{children:Object(D.jsx)(ee.a,{})}),Object(D.jsx)(Z.a,{primary:"Feeds"})]}),Object(D.jsxs)(Q.a,{button:!0,component:l.b,to:"/outputs",children:[Object(D.jsx)(Y.a,{children:Object(D.jsx)(te.a,{})}),Object(D.jsx)(Z.a,{primary:"Outputs"})]}),Object(D.jsx)(x.a,{}),Object(D.jsxs)(Q.a,{button:!0,component:l.b,to:"/explore",children:[Object(D.jsx)(Y.a,{children:Object(D.jsx)(ne.a,{})}),Object(D.jsx)(Z.a,{primary:"Explore"})]})]})},ae=n(433),ce=n(123),se=n(400),oe=n(428),ie=n(429),ue=n(430),le=n(432),je=n(120),de=n(282),be=["className","text","onClose","variant"],pe={success:oe.a,warning:ie.a,error:ue.a,info:y.a},he=Object(w.a)((function(e){return{success:{backgroundColor:je.a[600]},error:{backgroundColor:e.palette.error.dark},info:{backgroundColor:e.palette.primary.main},warning:{backgroundColor:de.a[700]},icon:{fontSize:20},iconVariant:{opacity:.9,marginRight:e.spacing(1)},message:{display:"flex",alignItems:"center"}}})),fe=function(e){var t=he(),n=e.className,r=e.text,a=e.onClose,c=e.variant,s=Object(ce.a)(e,be),o=pe[c];return Object(D.jsx)(se.a,Object(u.a)({className:q(t[c],n),"aria-describedby":"client-snackbar",message:Object(D.jsxs)("span",{id:"client-snackbar",className:t.message,children:[Object(D.jsx)(o,{className:q(t.icon,t.iconVariant)}),r]}),action:[Object(D.jsx)(p.a,{"aria-label":"close",color:"inherit",onClick:a,children:Object(D.jsx)(le.a,{className:t.icon})},"close")]},s))},xe=function(){var e=Object(r.useContext)(K).message,t=Object(r.useState)(!1),n=Object(o.a)(t,2),a=n[0],c=n[1];Object(r.useEffect)((function(){c(""!==e.text)}),[e]);var s=function(e,t){"clickaway"!==t&&c(!1)};return Object(D.jsx)(ae.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:a,autoHideDuration:5e3,onClose:s,children:Object(D.jsx)(fe,{text:e.text,variant:e.variant,onClose:s})})},Oe=n(26),me=n(283),ge=n(100),ve=n(434),we=n(435),ke=n(436),ye=n(437),Se=n(438),Ce=n.p+"static/media/feedpushr.581009c2.svg",Te=n(321),Ee=function(e){return Object(D.jsx)(Te.a,Object(u.a)(Object(u.a)({},e),{},{children:Object(D.jsx)("path",{d:"M12.007 0C6.12 0 1.1 4.27.157 10.08c-.944 5.813 2.468 11.45 8.054 13.312.19.064.397.033.555-.084.16-.117.25-.304.244-.5v-2.042c-3.33.735-4.037-1.56-4.037-1.56-.22-.726-.694-1.35-1.334-1.756-1.096-.75.074-.735.074-.735.773.103 1.454.557 1.846 1.23.694 1.21 2.23 1.638 3.45.96.056-.61.327-1.178.766-1.605-2.67-.3-5.462-1.335-5.462-6.002-.02-1.193.42-2.35 1.23-3.226-.327-1.015-.27-2.116.166-3.09 0 0 1.006-.33 3.3 1.23 1.966-.538 4.04-.538 6.003 0 2.295-1.5 3.3-1.23 3.3-1.23.445 1.006.49 2.144.12 3.18.81.877 1.25 2.033 1.23 3.226 0 4.607-2.805 5.627-5.476 5.927.578.583.88 1.386.825 2.206v3.29c-.005.2.092.393.26.507.164.115.377.14.565.063 5.568-1.88 8.956-7.514 8.007-13.313C22.892 4.267 17.884.007 12.008 0z"})}))},Ne=function(){var e=Object(r.useContext)(W).version;return Object(D.jsx)(h.a,{align:"right",color:"textSecondary",variant:"caption",children:e})},_e=Object(w.a)((function(e){return Object(me.a)({root:{padding:e.spacing(3,2),display:"flex",flexDirection:"column"},logo:{maxWidth:"50vw",alignSelf:"center"},link:{color:"rgba(0, 0, 0, 0.54)"}})})),Fe=function(){var e=_e();return Object(D.jsx)("div",{children:Object(D.jsxs)(ge.a,{className:e.root,children:[Object(D.jsx)(Ne,{}),Object(D.jsx)("img",{src:Ce,alt:"feedpushr",className:e.logo}),Object(D.jsxs)(ve.a,{showLabels:!0,children:[Object(D.jsx)(we.a,{label:"Sources",icon:Object(D.jsx)(Ee,{}),component:ke.a,href:"https://github.com/ncarlier/feedpushr",target:"_blank",rel:"noreferrer",className:e.link}),Object(D.jsx)(we.a,{label:"Features & Bugs",icon:Object(D.jsx)(ye.a,{}),component:ke.a,href:"https://github.com/ncarlier/feedpushr/issues",target:"_blank",rel:"noreferrer",className:e.link}),Object(D.jsx)(we.a,{label:"Support this project",icon:Object(D.jsx)(Se.a,{}),component:ke.a,href:"https://www.paypal.me/nunux",target:"_blank",rel:"noreferrer",className:e.link})]})]})})},Ie=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Feedpushr";Object(r.useEffect)((function(){document.title=e?"".concat(t," - ").concat(e):t}),[t,e])},Ue=(n(348),new Headers({"Content-Type":"application/json"})),Me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{headers:Ue},a=Object(r.useState)(!0),c=Object(o.a)(a,2),s=c[0],i=c[1],l=Object(r.useState)(),j=Object(o.a)(l,2),d=j[0],b=j[1],p=Object(r.useState)(),h=Object(o.a)(p,2),f=h[0],x=h[1],O=JSON.stringify(t);return Object(r.useEffect)((function(){var r=new AbortController;return function(){var a=Object(N.a)(E.a.mark((function a(){var c,s;return E.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,R(e,t,Object(u.a)(Object(u.a)({},n),{},{signal:r.signal}));case 3:if(!((c=a.sent).status>=300)){a.next=6;break}throw new Error(c.statusText);case 6:return a.next=8,c.json();case 8:s=a.sent,x(s),a.next=15;break;case 12:a.prev=12,a.t0=a.catch(0),"AbortError"!==a.t0.name&&b(a.t0);case 15:return a.prev=15,i(!1),a.finish(15);case 18:case"end":return a.stop()}}),a,null,[[0,12,15,18]])})));return function(){return a.apply(this,arguments)}}()(),function(){return r.abort()}}),[e,O]),[s,f,d]},Re=n(97),Ae=n.n(Re),Pe={"Content-Type":"application/x-www-form-urlencoded"},Le=[{title:"Feed",field:"title",render:function(e){return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(ke.a,{href:e.htmlUrl,target:"_blank",rel:"noreferrer",children:e.title}),Object(D.jsx)("p",{children:e.desc})]})}}],Be=function(){Ie("Find new RSS feed");var e=Object(r.useState)(null),t=Object(o.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(!1),s=Object(o.a)(c,2),i=s[0],u=s[1],l=Object(r.useContext)(K).showMessage,j=function(){var e=Object(N.a)(E.a.mark((function e(t){var n,r,c,s,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.prev=1,n=t.title,r=t.xmlUrl,e.next=5,R("/feeds",{title:n,url:r},{method:"POST",headers:Pe});case 5:if((c=e.sent).ok){e.next=11;break}return e.next=9,c.json();case 9:throw s=e.sent,new Error(s.detail||c.statusText);case 11:return a(null),e.next=14,c.json();case 14:o=e.sent,l("".concat(o.title," feed created")),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(1),a(e.t0);case 21:return e.prev=21,u(!1),e.finish(21);case 24:case"end":return e.stop()}}),e,null,[[1,18,21,24]])})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(N.a)(E.a.mark((function e(t){var n,r,a,c,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={data:[],page:0,totalCount:0},!((r=t.search.trim()).length<=2)){e.next=4;break}return e.abrupt("return",n);case 4:return e.next=6,R("/explore",{q:r},{method:"GET"});case 6:if((a=e.sent).ok){e.next=12;break}return e.next=10,a.json();case 10:throw c=e.sent,new Error(c.detail||a.statusText);case 12:return e.next=14,a.json();case 14:return s=e.sent,n.data=s,n.totalCount=s.length,e.abrupt("return",n);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(D.jsxs)(D.Fragment,{children:[!!n&&Object(D.jsx)(fe,{text:n.message,variant:"error"}),Object(D.jsx)(Ae.a,{title:"Search",columns:Le,data:d,isLoading:i,options:{debounceInterval:600,paging:!1,pageSize:10,actionsColumnIndex:-1,searchAutoFocus:!0},actions:[function(){return{icon:"add_box",tooltip:"Add feed",onClick:function(e,t){return j(t)}}}]})]})},De=n(298),ze=n(284),We=Object(w.a)((function(e){return Object(me.a)({root:{padding:e.spacing(2)},tags:{marginTop:e.spacing(2)},button:{marginRight:e.spacing(1),marginTop:e.spacing(2)}})})),He=function(e){var t=e.onSave,n=e.onCancel,c=e.feed,s=We(),l=a.a.useState({title:c?c.title:"",xmlUrl:c?c.xmlUrl:"",tags:c&&c.tags?c.tags:[]}),j=Object(o.a)(l,2),d=j[0],b=j[1],p=function(e){return function(t){b("tags"===e?Object(u.a)(Object(u.a)({},d),{},Object(i.a)({},e,t.target.value.split(","))):Object(u.a)(Object(u.a)({},d),{},Object(i.a)({},e,t.target.value)))}},h=Object(r.useCallback)((function(){t(d)}),[t,d]);return Object(D.jsxs)(ge.a,{className:s.root,children:[Object(D.jsxs)("form",{children:[Object(D.jsx)(De.a,{id:"title",label:"Title",value:d.title,onChange:p("title"),fullWidth:!0}),void 0===c&&Object(D.jsx)(De.a,{id:"xmlurl",label:"URL",type:"url",helperText:"ex: http://rss.cnn.com/rss/edition",value:d.xmlUrl,onChange:p("xmlUrl"),fullWidth:!0}),Object(D.jsx)(De.a,{id:"tags",label:"Tags",helperText:"Comma separated list of tags",value:d.tags.join(","),onChange:p("tags"),fullWidth:!0})]}),Object(D.jsx)(ze.a,{variant:"contained",className:s.button,onClick:n,children:"Cancel"}),Object(D.jsx)(ze.a,{variant:"contained",color:"primary",className:s.button,onClick:h,children:"Save"})]})},Je={"Content-Type":"application/x-www-form-urlencoded"},Ge=Object(Oe.g)((function(e){var t=e.history;Ie("new feed");var n=Object(r.useState)(null),a=Object(o.a)(n,2),c=a[0],s=a[1],i=Object(r.useContext)(K).showMessage;function u(){return(u=Object(N.a)(E.a.mark((function e(n){var r,a,c,o,u,l;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=n.title,a=n.xmlUrl,c=n.tags,e.next=4,R("/feeds",{title:r,url:a,tags:c},{method:"POST",headers:Je});case 4:if((o=e.sent).ok){e.next=10;break}return e.next=8,o.json();case 8:throw u=e.sent,new Error(u.detail||o.statusText);case 10:return s(null),e.next=13,o.json();case 13:return l=e.sent,i("".concat(l.title," feed created")),e.abrupt("return",t.push("/feeds"));case 18:e.prev=18,e.t0=e.catch(0),s(e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})))).apply(this,arguments)}return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(h.a,{variant:"h5",gutterBottom:!0,children:"New feed"}),!!c&&Object(D.jsx)(fe,{text:c.message,variant:"error"}),Object(D.jsx)(He,{onSave:function(e){return u.apply(this,arguments)},onCancel:function(){s(null),t.push("/feeds")}})]})})),Xe=n(285),Ke=Object(w.a)((function(){return{loader:{display:"flex",padding:"20px",justifyContent:"center"}}})),Ve=function(){var e=Ke();return Object(D.jsx)("div",{className:e.loader,children:Object(D.jsx)(Xe.a,{disableShrink:!0})})};var qe=function(e){return function(t,n,r){return Object(D.jsxs)(D.Fragment,{children:[t&&e.Loading(),r&&e.Error(r),n&&e.Data(n)]})}},$e={"Content-Type":"application/x-www-form-urlencoded"},Qe=function(e){var t=e.match,n=e.history,a=t.params.id;Ie("edit feed #".concat(a));var c=Object(r.useState)(null),s=Object(o.a)(c,2),i=s[0],u=s[1],l=Object(r.useContext)(K).showMessage,j=Me("/feeds/".concat(a)),d=Object(o.a)(j,3),b=d[0],p=d[1],f=d[2];function x(){u(null),n.push("/feeds")}function O(e){return m.apply(this,arguments)}function m(){return(m=Object(N.a)(E.a.mark((function e(t){var r,c,s,o,i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=t.title,c=t.tags,e.next=4,R("/feeds/".concat(a),{title:r,tags:c},{method:"PUT",headers:$e});case 4:if((s=e.sent).ok){e.next=10;break}return e.next=8,s.json();case 8:throw o=e.sent,new Error(o.detail||s.statusText);case 10:return u(null),e.next=13,s.json();case 13:return i=e.sent,l("".concat(i.title," feed updated")),e.abrupt("return",n.push("/feeds"));case 18:e.prev=18,e.t0=e.catch(0),u(e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})))).apply(this,arguments)}var g=qe({Loading:function(){return Object(D.jsx)(Ve,{})},Data:function(e){return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(h.a,{variant:"h5",gutterBottom:!0,children:"Configure feed"}),!!i&&Object(D.jsx)(fe,{text:i.message,variant:"error"}),Object(D.jsx)(He,{onSave:O,onCancel:x,feed:e})]})},Error:function(e){return Object(D.jsx)(fe,{text:"Unable to fetch feed: ".concat(e.message),variant:"error"})}});return Object(D.jsx)(D.Fragment,{children:g(b,p,f)})},Ye=n(455),Ze=function(e){var t=e.feed,n=Object(r.useState)(!1),a=Object(o.a)(n,2),c=a[0],s=a[1],i=Object(r.useContext)(K).showMessage;Object(r.useEffect)((function(){s("running"===t.status)}),[t]);return Object(D.jsx)(Ye.a,{color:"primary",title:"start/stop",checked:c,value:t.status,onChange:function(e,n){var r=n?"start":"stop";R("/feeds/".concat(t.id,"/").concat(r),null,{method:"POST"}).then((function(){s(n),i("".concat(t.title," feed is ").concat(n?"running":"stopped"))})).catch(console.error)}})},et=n(318),tt=n(299),nt=function(e){var t=e.value,n=e.title;return t?Object(D.jsx)(tt.a,{title:n||t,children:Object(D.jsx)("span",{children:Object(et.a)(t)})}):Object(D.jsx)("span",{children:"-"})},rt=function(e){return new Date(e).toUTCString()},at=function(e){var t=e.feed;return Object(D.jsx)(nt,{title:Object(D.jsxs)("dl",{children:[Object(D.jsx)("dt",{children:"created"}),Object(D.jsx)("dd",{children:rt(t.cdate)}),!!t.mdate&&Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)("dt",{children:"updated"}),Object(D.jsx)("dd",{children:rt(t.mdate)})]}),!!t.lastCheck&&Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)("dt",{children:"last check"}),Object(D.jsx)("dd",{children:rt(t.lastCheck)})]}),!!t.nextCheck&&Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)("dt",{children:"next check"}),Object(D.jsx)("dd",{children:rt(t.nextCheck)})]})]}),value:t.nextCheck})},ct=n(458),st=n(414),ot=n(402),it=Object(st.a)((function(e){return Object(ot.a)({margin:{marginRight:e.spacing(1)}})})),ut=function(e){var t=e.feed,n=it();return t.htmlUrl?Object(D.jsx)(tt.a,{title:"Open website in a new tab",className:n.margin,children:Object(D.jsx)(p.a,{"aria-label":"public",className:n.margin,size:"small",component:"a",href:t.htmlUrl,target:"_blank",children:Object(D.jsx)(ct.a,{fontSize:"inherit"})})}):null},lt=n(309),jt=n(459),dt=Object(st.a)((function(e){return Object(ot.a)({margin:{margin:e.spacing(1)}})})),bt=function(e){var t=e.feed,n=dt();return t.hubUrl?Object(D.jsx)(tt.a,{title:"WebSub ready",className:n.margin,children:Object(D.jsx)(lt.a,{variant:"outlined",size:"small",label:"hub",component:"a",href:t.hubUrl,clickable:!0,icon:Object(D.jsx)(jt.a,{})})}):null},pt=Object(w.a)((function(e){return{status:{display:"inline-block",alignItems:"center",backgroundColor:e.palette.primary.main,color:e.palette.primary.contrastText,minWidth:"2em",minHeight:"2em",padding:".5em!important",lineHeight:"1em",borderRadius:"500rem",textAlign:"center"},error:{backgroundColor:e.palette.error.dark},success:{backgroundColor:je.a[600]}}})),ht=function(e){var t=e.feed,n=pt(),r=Object(D.jsx)("div",{className:q(n.status),children:"0"}),a="No feed aggregated";return t.errorCount?(a=t.errorMsg?t.errorMsg:"unexpected error",r=Object(D.jsx)("div",{className:q(n.status,n.error),children:t.errorCount})):t.nbProcessedItems&&(a="Aggregation success",r=Object(D.jsx)("div",{className:q(n.status,n.success),children:t.nbProcessedItems})),Object(D.jsx)(tt.a,{title:a,children:r})},ft=Object(w.a)((function(e){return Object(me.a)({tag:{marginRight:e.spacing(.5)}})})),xt=function(e){var t=e.feed.tags,n=void 0===t?[]:t,r=ft();return Object(D.jsx)(D.Fragment,{children:n.map((function(e){return Object(D.jsx)(lt.a,{label:e,className:r.tag},e)}))})},Ot=n(460),mt=function(){var e=Object(r.useContext)(K).showMessage,t=function(){var t=Object(N.a)(E.a.mark((function t(){var n,r,a,c;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,R("/opml",null,{method:"GET"});case 3:if(!(n=t.sent).ok){t.next=17;break}return t.next=7,n.text();case 7:r=t.sent,(a=document.createElement("a")).setAttribute("href","data:text/xml;charset=utf-8,"+encodeURIComponent(r)),a.setAttribute("download","my-feedpushr-feeds.opml"),a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a),t.next=21;break;case 17:return t.next=19,n.json();case 19:throw c=t.sent,new Error(c.detail||n.statusText);case 21:t.next=26;break;case 23:t.prev=23,t.t0=t.catch(0),e("Unable to export feeds to OPML file: ".concat(t.t0.message),"error");case 26:case"end":return t.stop()}}),t,null,[[0,23]])})));return function(){return t.apply(this,arguments)}}();return Object(D.jsx)(tt.a,{title:"Export to OPML file",children:Object(D.jsxs)(ze.a,{size:"small",variant:"contained",color:"default",onClick:t,children:["Export",Object(D.jsx)(Ot.a,{})]})})},gt=n(21),vt=n(409),wt=n(446),kt=n(450),yt=n(449),St=n(448),Ct=n(461),Tt=["onSelectFile"],Et=Object(w.a)((function(){return{hidden:{opacity:0,position:"absolute",pointerEvents:"none",width:"1px",height:"1px"}}})),Nt=Object(r.forwardRef)((function(e,t){var n=e.onSelectFile,a=Object(ce.a)(e,Tt),c=Et(),s=Object(r.createRef)();return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)("input",{type:"file",ref:s,className:c.hidden,onChange:function(e){if(e.target.files){var t=e.target.files[0];t&&n(t)}}}),Object(D.jsx)(ze.a,Object(u.a)(Object(u.a)({},a),{},{ref:t,onClick:function(){s.current&&s.current.click()},children:a.children}))]})})),_t=n(117),Ft=function(e){var t=e.jobID,n=a.a.useState([]),r=Object(o.a)(n,2),c=r[0],s=r[1],i=a.a.useState("closed"),u=Object(o.a)(i,2),l=u[0],j=u[1];return a.a.useEffect((function(){var e=new EventSource("".concat(I,"/v2/opml/status/").concat(t));return e.onerror=function(){return j("error")},e.onopen=function(){return j("open")},e.onmessage=function(t){var n=t.data;if("done"===n)return e.close(),void j("closed");var r=n.split("|"),a={XMLURL:r[0],error:"ok"===r[1]?void 0:r[1]};s((function(e){return[a].concat(e)}))},function(){return e.close()}}),[t]),Object(D.jsxs)(D.Fragment,{children:["error"===l&&Object(D.jsx)(fe,{text:"unable to fetch import status",variant:"error"}),"open"===l&&Object(D.jsx)(Ve,{}),Object(D.jsx)($.a,{dense:!0,children:c.map((function(e,t){return Object(D.jsxs)(Q.a,{children:[Object(D.jsx)(Y.a,{children:e.error?Object(D.jsx)(ue.a,{style:{color:_t.a[500]}}):Object(D.jsx)(oe.a,{style:{color:je.a[500]}})}),Object(D.jsx)(Z.a,{primary:"[".concat(c.length-t,"] ").concat(e.XMLURL),secondary:e.error})]},"import-result-".concat(t))}))})]})},It=Object(Oe.g)((function(e){var t=e.style,n=e.history,c=a.a.useState(!1),s=Object(o.a)(c,2),i=s[0],u=s[1],l=a.a.useState(""),j=Object(o.a)(l,2),d=j[0],b=j[1],p=Object(gt.a)(),h=Object(vt.a)(p.breakpoints.down("sm")),f=Object(r.useContext)(K).showMessage,x=function(){u(!1),n.push("/"),n.replace("/feeds")},O=function(){var e=Object(N.a)(E.a.mark((function e(t){var n,r,a,c,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("file",t),e.prev=2,e.next=5,R("/opml",null,{method:"POST",body:n});case 5:if((r=e.sent).ok){e.next=11;break}return e.next=9,r.json();case 9:throw a=e.sent,new Error(a.detail||r.statusText);case 11:return e.next=13,r.json();case 13:c=e.sent,s=c.id,b(s),u(!0),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(2),f("Unable to import OPML file: ".concat(e.t0.message),"error");case 22:case"end":return e.stop()}}),e,null,[[2,19]])})));return function(t){return e.apply(this,arguments)}}();return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(tt.a,{title:"Import from OPML file",style:t,children:Object(D.jsxs)(Nt,{size:"small",variant:"contained",color:"default",onSelectFile:O,children:["Import",Object(D.jsx)(Ct.a,{})]})}),Object(D.jsxs)(wt.a,{fullScreen:h,open:i,onClose:x,"aria-labelledby":"import-dialog-title",children:[Object(D.jsx)(kt.a,{id:"import-dialog-title",children:"Import OPML file"}),Object(D.jsx)(yt.a,{children:Object(D.jsx)(Ft,{jobID:d})}),Object(D.jsx)(St.a,{children:Object(D.jsx)(ze.a,{autoFocus:!0,onClick:x,color:"primary",children:"Dismiss"})})]})]})})),Ut=[{title:"Aggregation",render:function(e){return!!e&&Object(D.jsx)(Ze,{feed:e})},field:"id",width:120},{title:"Status",field:"status",render:function(e){return!!e&&Object(D.jsx)(ht,{feed:e})},width:100},{title:"Title",field:"title",render:function(e){return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(ut,{feed:e}),Object(D.jsx)(ke.a,{href:e.xmlUrl,target:"_blank",children:e.title}),Object(D.jsx)(bt,{feed:e})]})}},{title:"Tags",field:"tags",render:function(e){return!!e&&Object(D.jsx)(xt,{feed:e})}},{title:"Next check",field:"nextCheck",render:function(e){return!!e&&Object(D.jsx)(at,{feed:e})}}],Mt=Object(Oe.g)((function(e){var t=e.history;Ie("feeds");var n=Object(r.useState)(null),a=Object(o.a)(n,2),c=a[0],s=a[1],i=Object(r.useContext)(K).showMessage,l=function(){var e=Object(N.a)(E.a.mark((function e(t){var n,r,a,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={q:t.search.trim(),page:t.page+1,size:t.pageSize},e.next=3,R("/feeds",n,{method:"GET"});case 3:if((r=e.sent).ok){e.next=9;break}return e.next=7,r.json();case 7:throw a=e.sent,new Error(a.detail||r.statusText);case 9:return e.next=11,r.json();case 11:return c=e.sent,e.abrupt("return",{data:c.data,page:c.current-1,totalCount:c.total});case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(N.a)(E.a.mark((function e(n){var r,a,c,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.id,a=n.title,e.prev=1,e.next=4,R("/feeds/".concat(r),null,{method:"DELETE"});case 4:if((c=e.sent).ok){e.next=10;break}return e.next=8,c.json();case 8:throw o=e.sent,new Error(o.detail||c.statusText);case 10:s(null),i("".concat(a," feed removed")),setTimeout((function(){t.push("/"),t.goBack()})),e.next=19;break;case 15:throw e.prev=15,e.t0=e.catch(1),s(e.t0),e.t0;case 19:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t){return e.apply(this,arguments)}}();return Object(D.jsxs)(D.Fragment,{children:[!!c&&Object(D.jsx)(fe,{text:c.message,variant:"error"}),Object(D.jsx)(Ae.a,{title:"Feeds",columns:Ut,data:l,editable:{onRowDelete:j},options:{debounceInterval:1e3,actionsColumnIndex:-1,paging:!0,pageSize:20,pageSizeOptions:[10,20,50,100],sorting:!1},actions:[{icon:"edit",tooltip:"Edit",onClick:function(e,n){return t.push("/feeds/".concat(n.id))}},{icon:"add_box",tooltip:"Add",isFreeAction:!0,onClick:function(){return t.push("/feeds/add")}}],components:{Toolbar:function(e){return Object(D.jsxs)("div",{children:[Object(D.jsx)(Re.MTableToolbar,Object(u.a)({},e)),Object(D.jsxs)("div",{style:{padding:"5px 10px"},children:[Object(D.jsx)(It,{style:{marginRight:"10px"}}),Object(D.jsx)(mt,{})]})]})}}})]})})),Rt=function(e){var t=e.match;return Object(D.jsxs)(Oe.d,{children:[Object(D.jsx)(Oe.b,{exact:!0,path:t.path+"/",component:Mt}),Object(D.jsx)(Oe.b,{exact:!0,path:t.path+"/add",component:Ge}),Object(D.jsx)(Oe.b,{path:t.path+"/:id",component:Qe})]})},At=n(291),Pt=function(e){var t=e.href,n=e.children;return Object(D.jsx)("a",{href:"https://github.com/ncarlier/feedpushr/blob/master/".concat(t),target:"_blank",rel:"noopener noreferrer",children:n})},Lt=n(451),Bt=n(453),Dt=n(452),zt=n(317),Wt=n.n(zt),Ht=function(e){return e.slice(0,e.indexOf(".")+1)},Jt=function(e){var t,n=e.spec,r=(t=n.desc).slice(t.indexOf(".")+1);return""===r?Object(D.jsx)(h.a,{color:"textSecondary",dangerouslySetInnerHTML:{__html:marked(Ht(n.desc))}}):Object(D.jsxs)(Lt.a,{style:{boxShadow:"none"},children:[Object(D.jsx)(Bt.a,{expandIcon:Object(D.jsx)(Wt.a,{}),children:Object(D.jsx)(h.a,{color:"textSecondary",dangerouslySetInnerHTML:{__html:marked(Ht(n.desc))}})}),Object(D.jsx)(Dt.a,{children:Object(D.jsx)(h.a,{color:"textSecondary",dangerouslySetInnerHTML:{__html:marked(r)}})})]})},Gt=Object(w.a)((function(e){return Object(me.a)({root:{padding:e.spacing(2)},condition:{marginTop:e.spacing(2)},button:{marginRight:e.spacing(1),marginTop:e.spacing(2)}})})),Xt=function(e){var t=e.onSave,n=e.onCancel,c=e.spec,s=e.source,l=Gt(),j=a.a.useState(s?s.alias:""),d=Object(o.a)(j,2),b=d[0],p=d[1],f=a.a.useState(s?s.props:{}),x=Object(o.a)(f,2),O=x[0],m=x[1],g=a.a.useState(s?s.condition:""),v=Object(o.a)(g,2),w=v[0],k=v[1],y=Object(r.useCallback)((function(){return function(e){p(e.target.value)}}),[]),S=Object(r.useCallback)((function(e){return function(t){m(Object(u.a)(Object(u.a)({},O),{},Object(i.a)({},e,t.target.value)))}}),[O]),C=Object(r.useCallback)((function(){return function(e){k(e.target.value)}}),[]),T=Object(r.useCallback)((function(){t({alias:b,name:c.name,props:O,condition:w,enabled:!!s&&s.enabled})}),[t,b,c,O,w,s]);return Object(D.jsxs)(ge.a,{className:l.root,children:[Object(D.jsx)(h.a,{variant:"h4",gutterBottom:!0,children:c.name}),Object(D.jsx)(Jt,{spec:c}),Object(D.jsxs)("form",{children:[Object(D.jsx)(h.a,{variant:"h5",children:"Alias"}),Object(D.jsx)(De.a,{id:"alias",helperText:"Alias",value:b,onChange:y(),fullWidth:!0}),c.props.length>0&&Object(D.jsx)(h.a,{variant:"h5",children:"Properties"}),c.props.map((function(e){return Object(D.jsx)(De.a,{id:e.name,label:e.name,helperText:e.desc,value:O[e.name],type:["select","textarea"].includes(e.type)?void 0:e.type,multiline:"textarea"===e.type,select:"select"===e.type,onChange:S(e.name),fullWidth:!0,children:e.options&&Object.entries(e.options).map((function(e){return Object(D.jsx)(At.a,{value:e[0],children:e[1]},e[0])}))},e.name)})),Object(D.jsx)(h.a,{variant:"h5",className:l.condition,children:"Condition"}),Object(D.jsx)(De.a,{id:"condition",helperText:Object(D.jsxs)(D.Fragment,{children:["Conditional expression (",Object(D.jsx)(Pt,{href:"EXPRESSION.md",children:"documentation"}),")"]}),type:"textarea",multiline:!0,value:w,onChange:C(),fullWidth:!0})]}),Object(D.jsx)(ze.a,{variant:"contained",className:l.button,onClick:n,children:"Cancel"}),Object(D.jsx)(ze.a,{variant:"contained",color:"primary",className:l.button,onClick:T,children:"Save"})]})},Kt=n(454),Vt=n(441),qt=n(443),$t=n(442),Qt=Object(r.createContext)({specs:[]}),Yt=function(e){var t=e.children,n=sessionStorage.getItem("filterSpecs")||"[]",a=Object(r.useState)(JSON.parse(n)),c=Object(o.a)(a,2),s=c[0],i=c[1],u=function(){var e=Object(N.a)(E.a.mark((function e(){var t,n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R("/filters/_specs",null,{method:"GET"});case 3:if((t=e.sent).ok){e.next=6;break}throw new Error(t.statusText);case 6:return e.next=8,t.json();case 8:n=e.sent,sessionStorage.setItem("filterSpecs",JSON.stringify(n)),i(n),console.debug("filter specs initialized",n),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error("unable to fetch filters specs",e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}();return s.length||u(),Object(D.jsx)(Qt.Provider,{value:{specs:s},children:t})},Zt=Object(r.createContext)({specs:[]}),en=function(e){var t=e.children,n=sessionStorage.getItem("outputSpecs")||"[]",a=Object(r.useState)(JSON.parse(n)),c=Object(o.a)(a,2),s=c[0],i=c[1],u=function(){var e=Object(N.a)(E.a.mark((function e(){var t,n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R("/outputs/_specs",null,{method:"GET"});case 3:if((t=e.sent).ok){e.next=6;break}throw new Error(t.statusText);case 6:return e.next=8,t.json();case 8:n=e.sent,sessionStorage.setItem("outputSpecs",JSON.stringify(n)),i(n),console.debug("output specs initialized",n),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error("unable to fetch outputs specs",e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}();return s.length||u(),Object(D.jsx)(Zt.Provider,{value:{specs:s},children:t})},tn=Object(w.a)({card:{heigth:"100%",display:"flex",flexDirection:"column"},title:{fontSize:14},pos:{marginBottom:12}}),nn=function(e){var t=e.onSelect,n=e.type,a=tn(),c=Object(r.useContext)(Zt),s=Object(r.useContext)(Qt),o=("output"===n?c:s).specs;return Object(D.jsx)(Kt.a,{spacing:2,container:!0,style:{padding:"0 1em"},children:o.map((function(e){return Object(D.jsx)(Kt.a,{item:!0,sm:12,md:4,lg:4,children:Object(D.jsxs)(Vt.a,{className:a.card,children:[Object(D.jsxs)(qt.a,{children:[Object(D.jsx)(h.a,{variant:"h5",component:"h2",children:e.name}),Object(D.jsx)(h.a,{color:"textSecondary",dangerouslySetInnerHTML:{__html:marked(Ht(e.desc))}})]}),Object(D.jsx)($t.a,{children:Object(D.jsx)(ze.a,{size:"small",onClick:function(){return t(e)},children:"Select"})})]})},e.name)}))})},rn=Object(Oe.g)((function(e){var t=e.history;Ie("add output");var n=Object(r.useState)(null),a=Object(o.a)(n,2),c=a[0],s=a[1],i=Object(r.useState)(null),u=Object(o.a)(i,2),l=u[0],j=u[1],d=Object(r.useContext)(K).showMessage;function b(){return(b=Object(N.a)(E.a.mark((function e(n){var r,a,c,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R("/outputs",null,{method:"POST",body:JSON.stringify(n)});case 3:if((r=e.sent).ok){e.next=9;break}return e.next=7,r.text();case 7:throw a=e.sent,new Error(a);case 9:return e.next=11,r.json();case 11:c=e.sent,s=c.alias?c.alias:c.name,d("".concat(s," output added")),t.push("/outputs"),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),j(e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,17]])})))).apply(this,arguments)}return null===c?Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(h.a,{variant:"h5",gutterBottom:!0,children:"Add output: Choose"}),Object(D.jsx)(nn,{onSelect:function(e){j(null),s(e)},type:"output"})]}):Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(h.a,{variant:"h5",gutterBottom:!0,children:"Add output: Configure"}),!!l&&Object(D.jsx)(fe,{text:l.message,variant:"error"}),Object(D.jsx)(Xt,{onSave:function(e){return b.apply(this,arguments)},onCancel:function(){j(null),s(null)},spec:c})]})})),an=function(e){var t=e.match,n=e.history,a=t.params.id;Ie("edit output");var c=Object(r.useState)(null),s=Object(o.a)(c,2),i=s[0],u=s[1],l=Object(r.useContext)(K).showMessage,j=Me("/outputs/".concat(a)),d=Object(o.a)(j,3),b=d[0],p=d[1],f=d[2],x=Object(r.useContext)(Zt).specs;function O(){n.push("/outputs")}function m(e){return g.apply(this,arguments)}function g(){return(g=Object(N.a)(E.a.mark((function e(t){var r,c,s,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R("/outputs/".concat(a),null,{method:"PUT",body:JSON.stringify(t)});case 3:if((r=e.sent).ok){e.next=9;break}return e.next=7,r.text();case 7:throw c=e.sent,new Error(c);case 9:return e.next=11,r.json();case 11:s=e.sent,o=s.alias?s.alias:s.name,l("".concat(o," output configured")),n.push("/outputs"),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),u(e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,17]])})))).apply(this,arguments)}var v=qe({Loading:function(){return Object(D.jsx)(Ve,{})},Data:function(e){var t=x.find((function(t){return t.name===e.name}));return t?Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(h.a,{variant:"h5",gutterBottom:!0,children:"Configure output"}),!!i&&Object(D.jsx)(fe,{text:i.message,variant:"error"}),Object(D.jsx)(Xt,{onSave:m,onCancel:O,spec:t,source:e})]}):Object(D.jsx)(fe,{text:"Unable to retrieve output specifications: ".concat(e.name),variant:"error"})},Error:function(e){return Object(D.jsx)(fe,{text:"Unable to fetch output: ".concat(e.message),variant:"error"})}});return Object(D.jsx)(D.Fragment,{children:v(b,p,f)})},cn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return e.length>t?e.slice(0,t)+"...":e},sn=function(e){var t=e.value;return Object(D.jsx)(tt.a,{title:t,children:Object(D.jsx)("span",{children:cn(t)})})},on=function(e,t,n){return"".concat(t||e," ").concat(n)},un=function(e){var t=e.name,n=e.alias,r=e.type;return on(t,n,r)},ln=function(e){var t=e.name,n=e.alias;return on(t,n,"filter")},jn=function(e){var t=e.entity,n=Object(r.useState)(t.enabled),a=Object(o.a)(n,2),c=a[0],s=a[1],i=Object(r.useContext)(K).showMessage,l="/outputs/".concat(t.id);function j(){return(j=Object(N.a)(E.a.mark((function e(n,r){var a,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(u.a)(Object(u.a)({},t),{},{enabled:r}),e.prev=1,e.next=4,R(l,null,{method:"PUT",body:JSON.stringify(a)});case 4:if(!(c=e.sent).ok){e.next=10;break}s(r),i("".concat(un(t)," ").concat(r?"enabled":"disabled")),e.next=11;break;case 10:throw new Error(c.statusText);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),i("Unable to update ".concat(un(t),": ").concat(e.t0.message),"error");case 16:case"end":return e.stop()}}),e,null,[[1,13]])})))).apply(this,arguments)}return"filter"===t.type&&(l="/outputs/".concat(t.parentId,"/filters/").concat(t.id)),Object(D.jsx)(tt.a,{title:"Enable/Disable",children:Object(D.jsx)(Ye.a,{color:"primary",checked:c,value:t.enabled,onChange:function(e,t){return j.apply(this,arguments)}})})},dn=Object(w.a)((function(e){return{status:{display:"inline-block",alignItems:"center",backgroundColor:e.palette.primary.main,color:e.palette.primary.contrastText,minWidth:"2em",minHeight:"2em",padding:".5em!important",lineHeight:"1em",borderRadius:"500rem",textAlign:"center"},error:{backgroundColor:e.palette.error.dark},success:{backgroundColor:je.a[600]}}})),bn=function(e){var t=e.entity,n=e.error,r=void 0!==n&&n,a=dn();if(r){if(t.nbError>0)return Object(D.jsx)("div",{className:q(a.status,a.error),children:t.nbError})}else if(t.nbSuccess>0)return Object(D.jsx)("div",{className:q(a.status,a.success),children:t.nbSuccess});return Object(D.jsx)("span",{children:"-"})},pn=[{title:"Enabled",render:function(e){return!!e&&Object(D.jsx)(jn,{entity:e})},sorting:!1,searchable:!1},{title:"Alias",field:"alias"},{title:"Type",field:"name"},{title:"Success",render:function(e){return!!e&&Object(D.jsx)(bn,{entity:e})},searchable:!1},{title:"Error",render:function(e){return!!e&&Object(D.jsx)(bn,{entity:e,error:!0})},searchable:!1},{title:"Condition",field:"condition",render:function(e){return Object(D.jsx)(sn,{value:e.condition})}}],hn=Object(Oe.g)((function(e){var t=e.entities,n=e.history,a=Object(r.useState)(t),c=Object(o.a)(a,2),s=c[0],i=c[1],u=Object(r.useState)(null),l=Object(o.a)(u,2),j=l[0],d=l[1],b=Object(r.useContext)(K).showMessage,p=function(){var e=Object(N.a)(E.a.mark((function e(t){var n,r,a,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,r="/outputs/".concat(n),"filter"===t.type&&(r="/outputs/".concat(t.parentId,"/filters/").concat(n)),e.prev=3,e.next=6,R(r,null,{method:"DELETE"});case 6:if(!(a=e.sent).ok){e.next=11;break}return d(null),b("".concat(un(t)," removed")),e.abrupt("return",i(s.filter((function(e){return e.id!==n&&e.parentId!==n}))));case 11:return e.next=13,a.json();case 13:throw c=e.sent,new Error(c.detail||a.statusText);case 17:throw e.prev=17,e.t0=e.catch(3),d(e.t0),e.t0;case 21:case"end":return e.stop()}}),e,null,[[3,17]])})));return function(t){return e.apply(this,arguments)}}();return Object(D.jsxs)(D.Fragment,{children:[!!j&&Object(D.jsx)(fe,{text:j.message,variant:"error"}),Object(D.jsx)(Ae.a,{title:"Outputs",columns:pn,data:s,parentChildData:function(e,t){return t.find((function(t){return t.id===e.parentId}))},editable:{onRowDelete:p},options:{actionsColumnIndex:-1,paging:!1,searchAutoFocus:!0},actions:[function(e){return{icon:"build",tooltip:"Configure",onClick:function(e,t){return n.push("/outputs/".concat(t.id))},hidden:"output"!==e.type}},function(e){return{icon:"playlist_add",tooltip:"Add filter",onClick:function(e,t){return n.push("/outputs/".concat(t.id,"/filters/add"))},hidden:"output"!==e.type}},function(e){return{icon:"build",tooltip:"Configure",onClick:function(e,t){return n.push("/outputs/".concat(t.parentId,"/filters/").concat(t.id))},hidden:"filter"!==e.type}},{icon:"add_box",tooltip:"Add",isFreeAction:!0,onClick:function(){return n.push("/outputs/add")}}]})]})})),fn=["filters"],xn=function(e){return e.reduce((function(e,t){var n=t.filters,r=Object(ce.a)(t,fn),a=Object(u.a)(Object(u.a)({},r),{},{type:"output"});if(e.push(a),n){var c=n.map((function(e){var t=Object(u.a)(Object(u.a)({},e),{},{type:"filter"});return t.parentId=a.id,t}));e.push.apply(e,Object(F.a)(c))}return e}),[])},On=function(){Ie("outputs");var e=Me("/outputs"),t=Object(o.a)(e,3),n=t[0],r=t[1],a=t[2],c=qe({Loading:function(){return Object(D.jsx)(Ve,{})},Data:function(e){return Object(D.jsx)(hn,{entities:xn(e)})},Error:function(e){return Object(D.jsx)(fe,{text:"Unable to retrieve outputs: ".concat(e.message),variant:"error"})}});return Object(D.jsx)(D.Fragment,{children:c(n,r,a)})},mn=function(e){var t=e.match,n=e.history,a=t.params.id;Ie("add filter");var c=Object(r.useState)(null),s=Object(o.a)(c,2),i=s[0],u=s[1],l=Object(r.useState)(null),j=Object(o.a)(l,2),d=j[0],b=j[1],p=Object(r.useContext)(K).showMessage;function f(){return(f=Object(N.a)(E.a.mark((function e(t){var r,c,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R("/outputs/".concat(a,"/filters"),null,{method:"POST",body:JSON.stringify(t)});case 3:if((r=e.sent).ok){e.next=9;break}return e.next=7,r.text();case 7:throw c=e.sent,new Error(c);case 9:return e.next=11,r.json();case 11:s=e.sent,p("Filter ".concat(s.name," added")),n.push("/outputs"),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),b(e.t0);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})))).apply(this,arguments)}return null===i?Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(h.a,{variant:"h5",gutterBottom:!0,children:"Add filter: Choose"}),Object(D.jsx)(nn,{onSelect:function(e){b(null),u(e)},type:"filter"})]}):Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(h.a,{variant:"h5",gutterBottom:!0,children:"Add filter: Configure"}),!!d&&Object(D.jsx)(fe,{text:d.message,variant:"error"}),Object(D.jsx)(Xt,{onSave:function(e){return f.apply(this,arguments)},onCancel:function(){b(null),u(null)},spec:i})]})},gn=function(e){var t=e.match,n=e.history,a=t.params,c=a.id,s=a.filterId;Ie("edit filter");var i=Object(r.useState)(null),u=Object(o.a)(i,2),l=u[0],j=u[1],d=Object(r.useContext)(K).showMessage,b=Me("/outputs/".concat(c)),p=Object(o.a)(b,3),f=p[0],x=p[1],O=p[2],m=Object(r.useContext)(Qt).specs;function g(){n.push("/outputs")}function v(e){return w.apply(this,arguments)}function w(){return(w=Object(N.a)(E.a.mark((function e(t){var r,a,o,i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R("/outputs/".concat(c,"/filters/").concat(s),null,{method:"PUT",body:JSON.stringify(t)});case 3:if((r=e.sent).ok){e.next=9;break}return e.next=7,r.text();case 7:throw a=e.sent,new Error(a);case 9:return e.next=11,r.json();case 11:o=e.sent,i=ln(o),d("".concat(i," configured")),n.push("/outputs"),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),j(e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,17]])})))).apply(this,arguments)}var k=qe({Loading:function(){return Object(D.jsx)(Ve,{})},Data:function(e){var t=function(e){var t=e.name,n=e.alias;return on(t,n,"output")}(e);if(!e.filters||0===e.filters.length)return Object(D.jsx)(fe,{text:"No filter found for ".concat(t),variant:"error"});var n=e.filters.find((function(e){return e.id===s}));if(!n)return Object(D.jsx)(fe,{text:"Filter not found in ".concat(t),variant:"error"});var r=m.find((function(e){return e.name===n.name}));return r?Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(h.a,{variant:"h5",gutterBottom:!0,children:"Configure filter"}),!!l&&Object(D.jsx)(fe,{text:l.message,variant:"error"}),Object(D.jsx)(Xt,{onSave:v,onCancel:g,spec:r,source:n})]}):Object(D.jsx)(fe,{text:"Unable to retrieve filter specifications: ".concat(n.name),variant:"error"})},Error:function(e){return Object(D.jsx)(fe,{text:"Unable to fetch filter: ".concat(e.message),variant:"error"})}});return Object(D.jsx)(D.Fragment,{children:k(f,x,O)})},vn=function(e){var t=e.match;return Object(D.jsx)(en,{children:Object(D.jsx)(Yt,{children:Object(D.jsxs)(Oe.d,{children:[Object(D.jsx)(Oe.b,{exact:!0,path:t.path+"/",component:On}),Object(D.jsx)(Oe.b,{exact:!0,path:t.path+"/add",component:rn}),Object(D.jsx)(Oe.b,{exact:!0,path:t.path+"/:id/filters/add",component:mn}),Object(D.jsx)(Oe.b,{exact:!0,path:t.path+"/:id/filters/:filterId",component:gn}),Object(D.jsx)(Oe.b,{path:t.path+"/:id",component:an})]})})})},wn=function(){return Object(D.jsxs)(Oe.d,{children:[Object(D.jsx)(Oe.a,{exact:!0,from:"/",to:"/feeds"}),Object(D.jsx)(Oe.b,{path:"/feeds",component:Rt}),Object(D.jsx)(Oe.b,{path:"/outputs",component:vn}),Object(D.jsx)(Oe.b,{path:"/explore",component:Be}),Object(D.jsx)(Oe.b,{path:"/about",component:Fe})]})},kn=Object(v.a)({palette:{primary:m.a,secondary:g.a}}),yn=Object(w.a)((function(e){return{root:{display:"flex"},toolbar:{paddingRight:24},toolbarIcon:Object(u.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"0 8px"},e.mixins.toolbar),appBar:{zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{marginLeft:240,width:"calc(100% - ".concat(240,"px)"),transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:36},menuButtonHidden:{display:"none"},title:{flexGrow:1},drawerPaper:{position:"relative",whiteSpace:"nowrap",width:240,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerPaperClose:Object(i.a)({overflowX:"hidden",transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),width:e.spacing(7)},e.breakpoints.up("sm"),{width:e.spacing(9)}),appBarSpacer:e.mixins.toolbar,content:{flexGrow:1,height:"100vh",overflow:"auto"},container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},paper:{padding:e.spacing(2),display:"flex",overflow:"auto",flexDirection:"column"},fixedHeight:{height:240}}})),Sn=function(){var e=yn({}),t=a.a.useState(!0),n=Object(o.a)(t,2),r=n[0],c=n[1];return Object(D.jsx)(H,{children:Object(D.jsx)(X,{children:Object(D.jsx)(l.a,{children:Object(D.jsxs)(C.a,{theme:kn,children:[Object(D.jsx)(j.a,{}),Object(D.jsx)(d.a,{position:"absolute",className:q(e.appBar,r?e.appBarShift:null),children:Object(D.jsxs)(b.a,{className:e.toolbar,children:[Object(D.jsx)(p.a,{edge:"start",color:"inherit","aria-label":"Open drawer",onClick:function(){return c(!0)},className:q(e.menuButton,r?e.menuButtonHidden:null),children:Object(D.jsx)(k.a,{})}),Object(D.jsx)(h.a,{component:"h1",variant:"h6",color:"inherit",noWrap:!0,className:e.title,children:"Feedpushr"}),Object(D.jsx)(p.a,{color:"inherit",component:l.b,to:"/about",children:Object(D.jsx)(y.a,{})})]})}),Object(D.jsxs)(f.a,{variant:"permanent",classes:{paper:q(e.drawerPaper,r?null:e.drawerPaperClose)},open:r,children:[Object(D.jsx)("div",{className:e.toolbarIcon,children:Object(D.jsx)(p.a,{onClick:function(){return c(!1)},children:Object(D.jsx)(S.a,{})})}),Object(D.jsx)(x.a,{}),Object(D.jsx)(re,{})]}),Object(D.jsxs)(V,{children:[Object(D.jsxs)("main",{className:e.content,children:[Object(D.jsx)("div",{className:e.appBarSpacer}),Object(D.jsx)(O.a,{maxWidth:"lg",className:e.container,children:Object(D.jsx)(wn,{})})]}),Object(D.jsx)(xe,{})]})]})})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(D.jsx)(Sn,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[396,1,2]]]);
//# sourceMappingURL=main.27172a69.chunk.js.map